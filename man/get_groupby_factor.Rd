% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{get_groupby_factor}
\alias{get_groupby_factor}
\title{Determine grouping factor from a data.frame or SummarizedExperiment}
\usage{
get_groupby_factor(x, groupby, sep = DELIMETER)
}
\arguments{
\item{x}{Either a \code{SummarizedExperiment} (in which case its \code{colData()} is used) or a \code{data.frame} whose rows correspond to samples/pseudobulks.}

\item{groupby}{Either:
\itemize{
\item A vector of length \code{nrow(x)}: treated as the grouping factor directly.
\item A character scalar or vector of column names in \code{x}: those columns are pasted (row‚Äêwise) with a delimiter to form the grouping factor.
}}

\item{sep}{Character string used to separate pasted values when \code{groupby} is multiple column names. Default is \code{"\$"}.}
}
\value{
A character vector (or factor) of length \code{nrow(x)}, representing the grouping factor.
If \code{groupby} was already the same length as \code{nrow(x)}, it is returned unchanged.
Otherwise, it pastes together columns of \code{x}.
}
\description{
If \code{groupby} is a vector whose length matches the number of rows (or columns), this function treats it as the grouping factor directly.
Otherwise, if \code{groupby} is one or more column names in a data.frame (or in \code{colData(se)}),
it pastes those columns together (with a delimiter) to form a grouping factor.
}
\examples{
df <- data.frame(
  sample = paste0("S", 1:4),
  celltype = c("A", "A", "B", "B"),
  batch = c("X", "Y", "X", "Y")
)

# Case 1: groupby is a factor vector
grp1 <- get_groupby_factor(df, groupby = c("A", "A", "B", "B"))

# Case 2: groupby is one column name
grp2 <- get_groupby_factor(df, groupby = "celltype")

# Case 3: groupby is multiple column names
grp3 <- get_groupby_factor(df, groupby = c("celltype", "batch"))

print(grp1)
print(grp2)
print(grp3)

}
\seealso{
\code{\link{filter_segments_and_samples}}, \code{\link{test_all_groups_as}}
}
