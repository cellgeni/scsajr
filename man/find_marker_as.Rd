% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{find_marker_as}
\alias{find_marker_as}
\title{Identify marker segments for each group via one‐vs‐rest tests}
\usage{
find_marker_as(pbas, groupby, parallel = FALSE, verbose = FALSE)
}
\arguments{
\item{pbas}{A \code{SummarizedExperiment} where each row is a segment and each column is a pseudobulk.
Must contain assays “i”, “e”, and “psi”.
Rows correspond to segments; columns correspond to samples/pseudobulks.}

\item{groupby}{Either:
\itemize{
\item A vector of length \code{ncol(pbas)} that directly gives a group label for each column, or
\item One or more column names in \code{colData(pbas)}, whose values (pasted together if multiple) define the grouping factor.
}
See \verb{\link{get_groupby_factor}} for details.}

\item{parallel}{Logical; if \code{TRUE}, fit per‐segment GLMs in parallel (requires a registered \code{plyr} backend). Default \code{FALSE}.}

\item{verbose}{Logical; if \code{TRUE}, prints each group being tested. Default \code{FALSE}.}
}
\value{
A list with three elements:
\describe{
\item{pv}{Matrix: Raw p‐values, with rows = segments, columns = group labels}
\item{fdr}{Matrix: Benjamini-Hochberg FDR (across all segments)}
\item{dpsi}{Matrix: Delta‐PSI (mean PSI(group) - mean PSI(others)) per segment}
}
Row names of each matrix are \code{rownames(pbas)}; column names are the unique groups.
}
\description{
For a \code{SummarizedExperiment} of splicing segments with assays “psi” (percent spliced‐in),
this function conducts, for each unique group label, a one‐vs‐rest quasi‐binomial GLM test
(i.e., comparing that group to all other samples).
It returns p‐values and delta‐PSI matrices (segments × groups).
}
\details{
\enumerate{
\item Builds a grouping factor via \code{get_groupby_factor(pbas, groupby)}.
\item For each unique label \code{group} in that factor:
\enumerate{
\item Creates a binary factor \code{f} where \code{f == TRUE} if sample’s group == \code{group}, FALSE otherwise.
\item Calls \code{fit_as_glm()} with \code{formula = x ~ f} and \code{data_terms = list(f = f)}, requesting p‐values (\code{return_pv = TRUE}).
\item Extracts the “group” p‐value column (corresponding to \code{f}) for each segment and stores in \code{pv[, group]}.
\item Computes \code{dpsi[, group]} as \code{mean(psi[segment, f]) - mean(psi[segment, !f])}.
}
\item Adjusts each column of \code{pv} by Benjamini-Hochberg into \code{fdr[, group]}.
}
}
\seealso{
\verb{\link{fit_as_glm}}, \verb{\link{get_groupby_factor}}, \verb{\link{calc_psi}}
}
