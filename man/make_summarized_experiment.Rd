% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{make_summarized_experiment}
\alias{make_summarized_experiment}
\title{Construct a SummarizedExperiment from raw segment data and metadata}
\usage{
make_summarized_experiment(data_list, col_data)
}
\arguments{
\item{data_list}{A list with at least one element named \code{seg}, where:
\itemize{
\item \code{data_list$seg} is a data.frame with columns:
\itemize{
\item \code{chr_id} (chromosome names matching those in the assays’ row names),
\item \code{start} (numeric start coordinate),
\item \code{stop} (numeric end coordinate),
\item \code{strand} (numeric code: \code{1} for '+', \code{-1} for '-', or \code{NA}/other for '*'),
\item plus any additional per‐segment metadata columns.
}
\item All other list elements are assay matrices (e.g., \code{i}, \code{e}, \code{counts}) whose row names
match \code{rownames(data_list$seg)} and whose column names match \code{rownames(col_data)}.
}}

\item{col_data}{A data.frame of column‐level metadata, where each row corresponds to a column
of the resulting \code{SummarizedExperiment}. Row names of \code{col_data} must match the column names
of each assay matrix provided in \code{data_list}.}
}
\value{
A \code{SummarizedExperiment} with:
\itemize{
\item \code{assays}: each list element of \code{data_list} (except \code{seg}) becomes an assay, with its matrix data.
\item \code{rowRanges}: a \code{GRanges} object constructed from \code{data_list$seg}, with ranges given by
\code{chr_id}, \code{start}, \code{stop}, \code{strand} (converted to \code{'+'}, \code{'-'}, or \code{'*'}), and additional
metadata columns stored in \code{elementMetadata(rowRanges)}.
\item \code{colData}: set to the provided \code{col_data}.
}
}
\description{
Given a list containing segment coordinate data (\code{seg}) and assay matrices (\code{i}, \code{e}, etc.),
this function builds a \code{SummarizedExperiment} by:
\enumerate{
\item Extracting \code{seg} (a data.frame of segment attributes) and using its columns to create
\code{rowRanges} (\code{GRanges}) with genomic coordinates and metadata.
\item Taking the remaining list elements as assays (each must be a matrix with rows matching \code{rownames(seg)}).
\item Incorporating provided column metadata \code{col_data} as \code{colData}.
}
}
\examples{
\dontrun{
# Example 'raw_list' structure:
raw_list <- list(
  seg = data.frame(
    chr_id = c("chr1", "chr1"),
    start = c(100000, 200000),
    stop = c(100100, 200100),
    strand = c(1, -1),
    gene_id = c("GENE1", "GENE2"),
    row.names = c("SEG1", "SEG2"),
    stringsAsFactors = FALSE
  ),
  i = matrix(1:4, nrow = 2, dimnames = list(c("SEG1", "SEG2"), c("S1", "S2"))),
  e = matrix(5:8, nrow = 2, dimnames = list(c("SEG1", "SEG2"), c("S1", "S2")))
)
col_metadata <- data.frame(
  sample_id = c("S1", "S2"),
  celltype = c("A", "B"),
  row.names = c("S1", "S2"),
  stringsAsFactors = FALSE
)

se_obj <- make_summarized_experiment(raw_list, col_metadata)
}

}
\seealso{
\code{\link[GenomicRanges]{GRanges}}, \code{\link[SummarizedExperiment]{SummarizedExperiment}}
}
