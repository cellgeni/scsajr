% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{test_pair_as}
\alias{test_pair_as}
\title{Test alternative splicing between two conditions (pairwise)}
\usage{
test_pair_as(pbas, groupby, conditions, parallel = FALSE)
}
\arguments{
\item{pbas}{A \code{SummarizedExperiment} where each row is a segment and each column is a pseudobulk.
Must contain assays named “i” (inclusion) and “e” (exclusion).
Rows correspond to segments; columns correspond to samples/pseudobulks.}

\item{groupby}{Either:
\itemize{
\item A vector of length \code{ncol(pbas)} that directly gives a group label for each column, or
\item One or more column names in \code{colData(pbas)}, whose values (pasted together if multiple) define the grouping factor.
}
See \code{\link{get_groupby_factor}} for details.}

\item{conditions}{A length‐2 character vector specifying the two group labels to compare (e.g., \code{c("A", "B")}).}

\item{parallel}{Logical; if \code{TRUE}, fit per‐segment GLMs in parallel (requires a registered \code{plyr} backend). Default \code{FALSE}.}
}
\value{
A data.frame with one row per segment (rownames = \code{rownames(pbas)}), containing columns:
\describe{
\item{overdispersion}{Estimated dispersion from each segment’s GLM.}
\item{pv}{Raw p‐value for the group term (two‐level factor).}
\item{fdr}{Benjamini–Hochberg FDR (across all segments).}
\item{dpsi}{Difference in mean PSI between \code{conditions[2]} and \code{conditions[1]}.}
}
}
\description{
For a \code{SummarizedExperiment} of splicing segments with assays “i” (inclusion counts) and “e” (exclusion counts),
this function tests for differential splicing between two specified groups (e.g., two cell types) using a quasi‐binomial GLM per segment.
It returns a data.frame of p‐values, FDR, and delta‐PSI between the two conditions.
}
\details{
\enumerate{
\item Converts \code{groupby} into a single grouping vector \code{group_factor} via \code{get_groupby_factor()}.
\item Filters \code{group_factor} and \code{pbas} to keep only columns corresponding to the two \code{conditions}.
\item Calls \code{fit_as_glm()} with \code{formula = x ~ group} to get raw p‐values for each segment.
\item Adjusts p‐values (Benjamini–Hochberg) into \code{fdr}.
\item Computes delta‐PSI (\code{dpsi}) per segment by pseudobulking and calling \code{calc_psi()}, then taking
mean PSI per condition and subtracting.
}
}
\seealso{
\code{\link{fit_as_glm}}, \code{\link{get_groupby_factor}}, \code{\link{calc_psi}}, \code{\link{pseudobulk}}, \code{\link{test_all_groups_as}}
}
