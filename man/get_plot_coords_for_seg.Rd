% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{get_plot_coords_for_seg}
\alias{get_plot_coords_for_seg}
\title{Determine genomic plotting coordinates for a segment with flanking exons}
\usage{
get_plot_coords_for_seg(sid, pb_all, gene_descr)
}
\arguments{
\item{sid}{Character scalar; the segment ID (rownames of \code{pb_all}) to center the plot on.}

\item{pb_all}{A \code{SummarizedExperiment} of pseudobulk splicing data. Its \code{rowRanges(pb_all)}
must include \code{gene_id}, \code{start}, \code{end}, and \code{strand}.}

\item{gene_descr}{A data.frame with gene annotations, where:
\itemize{
\item Row names are gene IDs,
\item Columns include \code{start} (gene start coordinate) and \code{end} (gene end coordinate).
}}
}
\value{
A named list with two numeric elements:
\itemize{
\item \code{start}: the genomic coordinate to begin plotting,
\item \code{stop}: the genomic coordinate to end plotting.
If no upstream exon is found, \code{start} is the gene start; if no downstream exon is found, \code{stop} is the gene end.
}
}
\description{
Given a segment ID (\code{sid}), a pseudobulk \code{SummarizedExperiment} (\code{pb_all}), and a gene annotation data.frame (\code{gene_descr}),
this function finds the closest “constant” upstream and downstream exons (using \code{find_nearest_constant_exons()})
and returns a plotting window that extends from 50 bp upstream of the upstream exon start
(or gene start if none) to 50 bp upstream of the downstream exon end (or gene end if none).
}
\details{
\enumerate{
\item Uses \code{find_nearest_constant_exons(pb_all, sid)} to get:
\itemize{
\item \code{up}: ID of the nearest upstream constant exon (or \code{NA}),
\item \code{down}: ID of the nearest downstream constant exon (or \code{NA}).
}
\item Extracts \code{gene_id} for \code{sid} from \code{rowRanges(pb_all)}.
\item If \code{up} is not \code{NA}, sets
\code{start = start(rowRanges(pb_all)[up, ]) - 50}
otherwise,
\code{start = gene_descr[gene_id, "start"]}.
\item If \code{down} is not \code{NA}, sets
\code{stop = end(rowRanges(pb_all)[down, ]) - 50}
otherwise,
\code{stop = gene_descr[gene_id, "end"]}.
\item Returns the two values as a named list.
}
}
\seealso{
\code{\link{find_nearest_constant_exons}}, \code{\link{plot_segment_coverage}}
}
