% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{select_markers}
\alias{select_markers}
\title{Select marker segments per cell type}
\usage{
select_markers(
  segment_stats,
  n = 5,
  fdr_thr = 0.05,
  dpsi_thr = 0.1,
  clean_duplicates = TRUE
)
}
\arguments{
\item{segment_stats}{A list containing numeric matrices \code{pv}, \code{fdr}, and \code{dpsi}
with rows = segments and cols = cell types.}

\item{n}{Integer: maximum number of markers to return per cell type (default: 5).}

\item{fdr_thr}{Numeric: false discovery rate cutoff (default: 0.05).}

\item{dpsi_thr}{Numeric: minimum absolute delta PSI cutoff (default: 0.1).}

\item{clean_duplicates}{Logical: if TRUE, keep only one entry per segment
(the one with highest |dpsi|) across all cell types (default: TRUE).}
}
\value{
A data.frame with columns \code{pv}, \code{fdr}, \code{dpsi}, \code{seg_id}, and \code{group}(cell type),
sorted by decreasing |dpsi|.
}
\description{
Filters markers by false discovery rate (FDR) and absolute delta PSI (dPSI),
then selects the top n markers per cell type, and removing duplicates
(keeping only the strongest marker per segment across all cell_type).
}
\examples{
# Load example data
data(pbasf)

# Select top 10 markers with stricter thresholds:
df <- select_markers(pbasf@metadata$markers, n = 10, fdr_thr = 0.01, dpsi_thr = 0.2)
head(df)
}
