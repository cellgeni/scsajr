% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{annotate_exons}
\alias{annotate_exons}
\title{Annotate exons with splice site sequences from a FASTA}
\usage{
annotate_exons(gtf, fa)
}
\arguments{
\item{gtf}{A data.frame of GTF entries with columns:
\itemize{
\item \code{transcript_id} (identifier for each transcript),
\item \code{feature} (e.g., \code{"exon"}),
\item \code{chr_id} (chromosome),
\item \code{start}, \code{stop} (numeric genomic coordinates),
\item \code{strand} (\code{"+"}, \code{"-"}, or \code{"*"}).
Rows may include non-exon features; only rows where \code{feature == "exon"} will receive exon numbers.
}}

\item{fa}{A named list of DNAString objects (FASTA) indexed by chromosome (matching \code{chr_id}),
suitable for extracting sequence via \code{get_site_seq()}.}
}
\value{
The input \code{gtf} data.frame with added columns:
\itemize{
\item \code{exon_number}: integer index of the exon within its transcript (NA if not an exon),
\item \code{transc_exon_count}: total exons in that transcript (NA if not an exon),
\item \code{asite}: string sequence flanking the acceptor (5′) splice site (NA if not an exon),
\item \code{dsite}: string sequence flanking the donor (3′) splice site (NA if not an exon).
}
}
\description{
For each exon entry in a GTF data.frame, this function assigns:
\itemize{
\item \code{exon_number}: position of the exon in the transcript (1-based),
\item \code{transc_exon_count}: total number of exons in the transcript,
\item \code{asite}: sequence around the acceptor site,
\item \code{dsite}: sequence around the donor site.
}
}
\details{
\enumerate{
\item Splits \code{gtf} by \code{transcript_id}.
\item For each transcript:
\itemize{
\item Orders rows by \code{start} ascending (if \code{strand == "+"}) or descending (if \code{"-"}).
\item For rows with \code{feature == "exon"}, assigns \code{exon_number} from 1 to \code{n_exons} and
sets \code{transc_exon_count = n_exons}.
}
\item Initializes \code{asite} and \code{dsite} as \code{NA}.
\item For exonic rows (\code{feature == "exon"}):
\itemize{
\item If \code{strand == "+"},
\itemize{
\item \code{asite <- get_site_seq(chr_id, start, mars = c(12, 5), fa, rev = FALSE)},
\item \code{dsite <- get_site_seq(chr_id, stop,  mars = c(3, 5), fa, rev = FALSE)}.
}
\item If \code{strand == "-"},
\itemize{
\item \code{asite <- get_site_seq(chr_id, stop,  mars = c(5, 12), fa, rev = TRUE)},
\item \code{dsite <- get_site_seq(chr_id, start, mars = c(5, 3),  fa, rev = TRUE)}.
}
}
}
}
\seealso{
\code{\link{get_site_seq}}
}
