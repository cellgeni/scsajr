% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scsajr.R
\name{test_all_groups_as}
\alias{test_all_groups_as}
\title{Test alternative splicing across all groups simultaneously}
\usage{
test_all_groups_as(pbas, groupby, parallel = FALSE)
}
\arguments{
\item{pbas}{A \code{SummarizedExperiment} where each row is a segment and each column is a pseudobulk.
Must contain assays named “i” (inclusion) and “e” (exclusion).
Rows correspond to segment IDs; columns correspond to samples/pseudobulks.}

\item{groupby}{Either:
\itemize{
\item A vector of length \code{ncol(pbas)} that directly gives a group label for each column, or
\item One or more column names in \code{colData(pbas)}, whose values (pasted together if multiple) define the grouping factor.
}
See \verb{\link{get_groupby_factor}} for details.}

\item{parallel}{Logical; if \code{TRUE}, fit per‐segment GLMs in parallel (requires a registered \code{plyr} backend). Default \code{FALSE}.}
}
\value{
A data.frame with one row per segment (rownames = \code{rownames(pbas)} (segment IDs)), containing columns:
\describe{
\item{overdispersion}{Estimated dispersion from each segment’s GLM.}
\item{group}{Raw p‐value from the likelihood‐ratio test for the \code{group} term.}
\item{group_fdr}{Benjamini‐Hochberg adjusted FDR (across all segments).}
\item{low_state}{Group label with lowest mean PSI (from \code{get_dpsi()}).}
\item{high_state}{Group label with highest mean PSI.}
\item{dpsi}{Difference in mean PSI between \code{high_state} and \code{low_state}.}
}
}
\description{
For a \code{SummarizedExperiment} of splicing segments with assays “i” (inclusion counts) and “e” (exclusion counts),
this function tests whether PSI differs across multiple groups (e.g., cell types) using a quasi‐binomial GLM.
It returns a data.frame of p‐values, adjusted FDR, and delta‐PSI for each segment.
}
\details{
\enumerate{
\item Converts \code{groupby} into a single grouping vector \code{group_factor} via \code{get_groupby_factor()}.
\item Calls \code{fit_as_glm()} with formula \code{x ~ group}, where \code{x} is the per‐segment \code{cbind(i,e)}.
\item Extracts raw p‐values for the \code{group} term, adjusts them (Benjamini-Hochberg) into \code{group_fdr}.
\item Computes delta‐PSI (\code{dpsi}), \code{low_state}, and \code{high_state} for each segment via \code{get_dpsi()}.
\item Combine results (endure matching row order)
}
}
\seealso{
\verb{\link{fit_as_glm}}, \verb{\link{get_groupby_factor}}, \verb{\link{get_dpsi}}, \verb{\link{test_pair_as}}
}
